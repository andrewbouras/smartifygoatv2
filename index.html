<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>MCQ Viewer</title>
<style>
  body {
    font-family: sans-serif;
    max-width: 600px;
    margin: 20px auto;
    line-height: 1.5;
    background-color: #1a1a1a;
    color: #e0e0e0;
  }
  .question-block {
    border: 1px solid #444;
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 4px;
    background-color: #2a2a2a;
  }
  .question-block h2 {
    margin: 0 0 10px;
    font-size: 1.1rem;
    color: #fff;
  }
  .choices {
    margin-bottom: 10px;
  }
  .choice {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
  }
  .choice input {
    margin-right: 10px;
  }
  .choice label {
    color: #e0e0e0;
  }
  .explanation {
    background: #333;
    padding: 10px;
    border-left: 4px solid #555;
    margin-top: 10px;
    font-size: 0.9rem;
  }
  .correct {
    background-color: #1b3320;
    border-left-color: #2d5a3c;
  }
  .incorrect {
    background-color: #3d2020;
    border-left-color: #5a2d2d;
  }
  .factoid {
    font-size: 0.8rem;
    color: #aaa;
    margin-top: 5px;
  }
</style>
</head>
<body>

<h1>MCQ Practice</h1>
<div id="mcq-container">Loading MCQs...</div>

<script>
  async function loadMCQs() {
    try {
        // Get list of MCQ files
        const response = await fetch('python/mcqs/mcqs.json');
        const data = await response.json();
        
        if (!data.mcqs) {
            throw new Error('Invalid MCQ file format');
        }
        
        displayMCQs(data.mcqs);
    } catch (error) {
        console.error('Error loading MCQs:', error);
        document.getElementById('mcq-container').textContent = 
            'Error loading MCQs: ' + error.message;
    }
  }

  function showExplanation(mcq, block, selectedValue) {
    // Remove existing explanation if any
    const oldExp = block.querySelector('.explanation');
    if (oldExp) oldExp.remove();

    const explanationDiv = document.createElement('div');
    explanationDiv.className = 'explanation';

    const correctChoice = mcq.answerChoices.find(c => c.correct);
    const isCorrect = correctChoice && selectedValue === correctChoice.value;

    if (isCorrect) {
      explanationDiv.classList.add('correct');
      explanationDiv.textContent = 'Correct! ' + mcq.explanation;
    } else {
      explanationDiv.classList.add('incorrect');
      explanationDiv.textContent = 'Incorrect. The correct answer is: ' + 
        (correctChoice ? correctChoice.value : 'No correct answer found') + '. ' + mcq.explanation;
    }

    // Factoid section
    const factoidDiv = document.createElement('div');
    factoidDiv.className = 'factoid';
    factoidDiv.textContent = 'Factoid: ' + mcq.factoid;

    explanationDiv.appendChild(factoidDiv);
    block.appendChild(explanationDiv);
  }

  function displayMCQs(mcqs) {
    const container = document.getElementById('mcq-container');
    container.innerHTML = '';
    
    mcqs.forEach((mcq, index) => {
        const block = document.createElement('div');
        block.className = 'question-block';
        
        // Question title
        const qTitle = document.createElement('h2');
        qTitle.textContent = (index + 1) + '. ' + mcq.question;
        block.appendChild(qTitle);
        
        // Choices
        const choicesDiv = document.createElement('div');
        choicesDiv.className = 'choices';
        
        // Sort answer choices alphabetically by value
        const sortedChoices = [...mcq.answerChoices].sort((a, b) => 
            a.value.localeCompare(b.value)
        );
        
        sortedChoices.forEach((choice, choiceIndex) => {
            const choiceDiv = document.createElement('div');
            choiceDiv.className = 'choice';
            
            const input = document.createElement('input');
            input.type = 'radio';
            input.name = 'q' + index;
            input.value = choice.value;
            input.id = 'q' + index + 'c' + choiceIndex;
            
            input.addEventListener('change', () => {
                showExplanation(mcq, block, choice.value);
            });
            
            const label = document.createElement('label');
            label.htmlFor = input.id;
            label.textContent = choice.value;
            
            choiceDiv.appendChild(input);
            choiceDiv.appendChild(label);
            choicesDiv.appendChild(choiceDiv);
        });
        
        block.appendChild(choicesDiv);
        container.appendChild(block);
    });
  }

  loadMCQs();
</script>

</body>
</html>